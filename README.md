# north-america-mosques
This is a set of python scripts to exctract mosques data from Google Places API run over the North American region. 

##### Results of the scripts run in March 2017
https://fusiontables.google.com/DataSource?docid=1_e6DLtDSOWnK-m66cf21BTQS2zOuZ3EJPd6HmvtH#map:id=3

also at 
https://adnanwarsi.carto.com/builder/716de5cd-c043-48f5-92a5-3c107afa1754/embed?state=%7B%22map%22%3A%7B%22ne%22%3A%5B1.6696855009865839%2C-129.90234375000003%5D%2C%22sw%22%3A%5B60.28340847828245%2C-41.30859375000001%5D%2C%22center%22%3A%5B36.1733569352216%2C-85.56152343750001%5D%2C%22zoom%22%3A4%7D%2C%22widgets%22%3A%7B%2251d7e6c7-042e-4f3c-97e7-e0b3099092ab%22%3A%7B%22autoStyle%22%3Atrue%7D%7D%7D

### The following sequence of scripts
with installed packages - geopy, googlemaps, io, json, math, openpyxl, os, re, requests, sys, time, xlwt

#### 01_generate_search_coords.py
Generate the radial search coordinates.  The coordinates are placed across such that radial search circles
will form a honeycomb lattice.  The maximum distance across the coordinates is sqrt(3)*R, so that circles
overlap enough to cover all area.  The script creates a __search_coords.xls__ file with coordiantes.

#### 02_qualify_search_coords_tobe_incountry.py
this script runs over all coordinates in the __search_coords.xls__ file generated by the previous script,
to qualify if the coordinate is in the United States. A column added will indicate the qualifier.

#### Manual edit of file
filter out only the coordinates within the US and store the file as __only_us_coords.xlsx__

#### 03_search_radial_all_coords_with_keyword.py
run this script on the  __only_us_coords.xlsx__ coords file _3 seperate times_. One each with argument
for keyword search : __Mosque__, __Masjid__ & __Muslim__ . each run will generate
corresponding set of files in the directory __places_search_data__

#### 04_combine_data_files_info.py
run this script with the folder (__places_search_data__) that was generated by previous script runs.
It will create a json file __composite_data_file.json__ which contains all
place nodes and their data

#### 05_create_xls_from_big_data_file.py
this script takes the __composite_data_file.json__ to generate excel file
with all the places and their fields.

#### 06_scan_website_for_hints.py
run this script with the .xlsx file from the previous scripts to scan respective
websites to determine if any of the sunni mosques are actually any other sect.

#### 07_FourSquare_Stats_for_xls_data.py
run this script with the .xlsx file as argument. It queries FourSquare API centered at the Lat,Lon
of each record with a 100m radius.  If there is a result found, it extracts the 'userscount' to proxy
for the foot-traffic at teh location.

#### 08_scan_websites_for_email_contacts.py
this script scans the website, if exists, for each record to search for email
address, if found, and record it.

